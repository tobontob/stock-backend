#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
경량화된 금융 키워드 데이터셋 로더
"""

import json
import os
import glob
from typing import Dict, List, Set, Optional

class FinancialKeywordLoader:
    """경량화된 금융 키워드 데이터셋 로더"""
    
    def __init__(self, dataset_path: Optional[str] = None):
        self.dataset_path = dataset_path or self._find_dataset()
        self.financial_keywords = {}
        self.sentiment_keywords = {}
        self.impact_rules = {}
        self.load_dataset()
    
    def _find_dataset(self) -> str:
        """데이터셋 파일 자동 탐색"""
        candidates = [
            "financial_keywords_dataset.json",
            "data/financial_keywords_dataset.json",
            "news_analyzer/financial_keywords_dataset.json"
        ]
        
        for candidate in candidates:
            if os.path.exists(candidate):
                return candidate
        
        # 파일이 없으면 기본 키워드로 초기화
        print("[경고] 금융 키워드 데이터셋 파일을 찾을 수 없습니다. 기본 키워드를 사용합니다.")
        return None
    
    def load_dataset(self):
        """데이터셋 로드"""
        if not self.dataset_path or not os.path.exists(self.dataset_path):
            self._load_default_keywords()
            return
        
        try:
            with open(self.dataset_path, 'r', encoding='utf-8') as f:
                data = json.load(f)
            
            self.financial_keywords = data.get('financial_keywords', {})
            self.sentiment_keywords = data.get('sentiment_keywords', {})
            
            # 영향도 룰셋 로드
            impact_rules_path = self.dataset_path.replace('dataset.json', 'impact_rules.json')
            if os.path.exists(impact_rules_path):
                with open(impact_rules_path, 'r', encoding='utf-8') as f:
                    self.impact_rules = json.load(f)
            else:
                self._create_default_impact_rules()
            
            print(f"[금융키워드] 데이터셋 로드 완료: {self.dataset_path}")
            print(f"  - 금융 키워드 카테고리: {len(self.financial_keywords)}개")
            print(f"  - 감정 키워드: {len(self.sentiment_keywords)}개")
            print(f"  - 영향도 룰: {len(self.impact_rules)}개")
            
        except Exception as e:
            print(f"[오류] 데이터셋 로드 실패: {e}")
            self._load_default_keywords()
    
    def _load_default_keywords(self):
        """기본 키워드 로드 (확장된 버전)"""
        self.financial_keywords = {
            'stock_keywords': {
                '주식': 100, '주가': 95, '상장': 80, '배당': 75, '주주': 70,
                'PER': 65, 'PBR': 60, 'ROE': 55, '시가총액': 50, 'EPS': 45,
                'BPS': 40, '배당률': 35, '배당수익률': 30, '자기주식': 25,
                '스톡옵션': 20, '우선주': 15, '보통주': 10, '전환사채': 5,
                '신주인수권증권': 3, '상장폐지': 1, 'IPO': 90, '공모주': 85,
                '시장가': 80, '액면가': 75, '시가배율': 70, '수익률': 65,
                '수익성': 60, '성장성': 55, '안정성': 50, '유동성': 45,
                '거래량': 40, '거래대금': 35, '시장지배력': 30, '경쟁력': 25,
                '시장점유율': 20, '브랜드가치': 15, '기업가치': 10, '주가수익비율': 5,
                '주가순자산비율': 95, '주가매출비율': 90, '주가현금흐름비율': 85,
                '주가잉여현금흐름비율': 80, '주가매출성장비율': 75, '주가수익성장비율': 70,
                '주가배당비율': 65, '주가배당수익률': 60, '주가배당성장비율': 55,
                '주가배당안정성': 50, '주가배당지속성': 45, '주가배당성장성': 40,
                '주가배당수익성': 35, '주가배당안정성': 30, '주가배당지속성': 25,
                '주가배당성장성': 20, '주가배당수익성': 15, '주가배당안정성': 10,
                '주가배당지속성': 5, '주가배당성장성': 3, '주가배당수익성': 1,
                '시가총액순위': 95, '시가총액비중': 90, '시가총액변화': 85,
                '시가총액증감': 80, '시가총액증가': 75, '시가총액감소': 70,
                '시가총액상승': 65, '시가총액하락': 60, '시가총액급등': 55,
                '시가총액급락': 50, '시가총액호조': 45, '시가총액악화': 40,
                '시가총액성장': 35, '시가총액위축': 30, '시가총액확대': 25,
                '시가총액축소': 20, '시가총액개선': 15, '시가총액악화': 10,
                '시가총액회복': 5, '시가총액위축': 3, '시가총액확대': 1,
                '거래량증가': 95, '거래량감소': 90, '거래량급증': 85,
                '거래량급감': 80, '거래량호조': 75, '거래량악화': 70,
                '거래량상승': 65, '거래량하락': 60, '거래량돌파': 55,
                '거래량신고점': 50, '거래량신저점': 45, '거래량기대': 40,
                '거래량우려': 35, '거래량리스크': 30, '거래량위험': 25,
                '거래량약세': 20, '거래량강세': 15, '거래량보합': 10,
                '거래량관망': 5, '거래량대기': 3, '거래량검토': 1,
                '배당성장': 95, '배당감소': 90, '배당증가': 85,
                '배당축소': 80, '배당호조': 75, '배당악화': 70,
                '배당상승': 65, '배당하락': 60, '배당돌파': 55,
                '배당신고점': 50, '배당신저점': 45, '배당기대': 40,
                '배당우려': 35, '배당리스크': 30, '배당위험': 25,
                '배당약세': 20, '배당강세': 15, '배당보합': 10,
                '배당관망': 5, '배당대기': 3, '배당검토': 1
            },
            'economic_indicators': {
                'GDP': 100, '금리': 95, '환율': 90, '인플레이션': 85,
                '실업률': 80, '무역수지': 75, '경상수지': 70, 'GNP': 65,
                '물가상승률': 60, 'CPI': 55, 'PPI': 50, '고용률': 45,
                '기준금리': 40, 'LIBOR': 35, 'CD금리': 30, '국채금리': 25,
                '회사채금리': 20, '달러환율': 15, '엔환율': 10, '유로환율': 5,
                '원화강세': 3, '원화약세': 1, '자본수지': 80, '외환보유액': 75,
                '외채': 70, '국제수지': 65, '경상수지': 60, '자본수지': 55,
                '금융수지': 50, '경제성장률': 45, '소비자물가지수': 40,
                '생산자물가지수': 35, '고용지표': 30, '소득지표': 25,
                '소비지표': 20, '투자지표': 15, '수출입지표': 10,
                'GDP성장률': 95, 'GDP증감': 90, 'GDP증가': 85, 'GDP감소': 80,
                'GDP상승': 75, 'GDP하락': 70, 'GDP급등': 65, 'GDP급락': 60,
                'GDP호조': 55, 'GDP악화': 50, 'GDP성장': 45, 'GDP위축': 40,
                'GDP확대': 35, 'GDP축소': 30, 'GDP개선': 25, 'GDP악화': 20,
                'GDP회복': 15, 'GDP위축': 10, 'GDP확대': 5, 'GDP축소': 3,
                '금리상승': 95, '금리하락': 90, '금리인상': 85, '금리인하': 80,
                '금리동결': 75, '금리변동': 70, '금리조정': 65, '금리정책': 60,
                '금리기준': 55, '금리수준': 50, '금리환경': 45, '금리전망': 40,
                '금리기대': 35, '금리우려': 30, '금리리스크': 25, '금리위험': 20,
                '금리약세': 15, '금리강세': 10, '금리보합': 5, '금리관망': 3,
                '환율상승': 95, '환율하락': 90, '환율급등': 85, '환율급락': 80,
                '환율호조': 75, '환율악화': 70, '환율성장': 65, '환율위축': 60,
                '환율확대': 55, '환율축소': 50, '환율개선': 45, '환율악화': 40,
                '환율회복': 35, '환율위축': 30, '환율확대': 25, '환율축소': 20,
                '환율개선': 15, '환율악화': 10, '환율회복': 5, '환율위축': 3,
                '인플레이션상승': 95, '인플레이션하락': 90, '인플레이션급등': 85,
                '인플레이션급락': 80, '인플레이션호조': 75, '인플레이션악화': 70,
                '인플레이션성장': 65, '인플레이션위축': 60, '인플레이션확대': 55,
                '인플레이션축소': 50, '인플레이션개선': 45, '인플레이션악화': 40,
                '인플레이션회복': 35, '인플레이션위축': 30, '인플레이션확대': 25,
                '인플레이션축소': 20, '인플레이션개선': 15, '인플레이션악화': 10,
                '인플레이션회복': 5, '인플레이션위축': 3, '인플레이션확대': 1
            },
            'corporate_activities': {
                '실적': 100, '매출': 95, '영업이익': 90, '투자': 85,
                'M&A': 80, '신제품': 75, 'R&D': 70, '당기순이익': 65,
                '영업손실': 60, '적자': 55, '흑자': 50, '매출액': 45,
                '영업이익률': 40, '순이익률': 35, '부채비율': 30, '유동비율': 25,
                '당좌비율': 20, '합병': 15, '분할': 10, '스핀오프': 5,
                '자회사': 3, '지주회사': 1, '특허': 80, '라이센스': 75,
                '기술이전': 70, '기술개발': 65, '혁신': 60, '디지털전환': 55,
                'ESG': 50, '지속가능성': 45, '친환경': 40, '사회책임': 35,
                '지배구조': 30, '투명성': 25, '윤리경영': 20, '리스크관리': 15,
                '실적상승': 95, '실적하락': 90, '실적급등': 85, '실적급락': 80,
                '실적호조': 75, '실적악화': 70, '실적성장': 65, '실적위축': 60,
                '실적확대': 55, '실적축소': 50, '실적개선': 45, '실적악화': 40,
                '실적회복': 35, '실적위축': 30, '실적확대': 25, '실적축소': 20,
                '실적개선': 15, '실적악화': 10, '실적회복': 5, '실적위축': 3,
                '매출상승': 95, '매출하락': 90, '매출급등': 85, '매출급락': 80,
                '매출호조': 75, '매출악화': 70, '매출성장': 65, '매출위축': 60,
                '매출확대': 55, '매출축소': 50, '매출개선': 45, '매출악화': 40,
                '매출회복': 35, '매출위축': 30, '매출확대': 25, '매출축소': 20,
                '매출개선': 15, '매출악화': 10, '매출회복': 5, '매출위축': 3,
                '영업이익상승': 95, '영업이익하락': 90, '영업이익급등': 85,
                '영업이익급락': 80, '영업이익호조': 75, '영업이익악화': 70,
                '영업이익성장': 65, '영업이익위축': 60, '영업이익확대': 55,
                '영업이익축소': 50, '영업이익개선': 45, '영업이익악화': 40,
                '영업이익회복': 35, '영업이익위축': 30, '영업이익확대': 25,
                '영업이익축소': 20, '영업이익개선': 15, '영업이익악화': 10,
                '영업이익회복': 5, '영업이익위축': 3, '영업이익확대': 1,
                '투자확대': 95, '투자축소': 90, '투자증가': 85, '투자감소': 80,
                '투자호조': 75, '투자악화': 70, '투자성장': 65, '투자위축': 60,
                '투자확대': 55, '투자축소': 50, '투자개선': 45, '투자악화': 40,
                '투자회복': 35, '투자위축': 30, '투자확대': 25, '투자축소': 20,
                '투자개선': 15, '투자악화': 10, '투자회복': 5, '투자위축': 3,
                'M&A성공': 95, 'M&A실패': 90, 'M&A진행': 85, 'M&A완료': 80,
                'M&A호조': 75, 'M&A악화': 70, 'M&A성장': 65, 'M&A위축': 60,
                'M&A확대': 55, 'M&A축소': 50, 'M&A개선': 45, 'M&A악화': 40,
                'M&A회복': 35, 'M&A위축': 30, 'M&A확대': 25, 'M&A축소': 20,
                'M&A개선': 15, 'M&A악화': 10, 'M&A회복': 5, 'M&A위축': 3
            },
            'financial_keywords': {
                '은행': 100, '대출': 95, '펀드': 90, '보험': 85,
                '증권': 80, 'ETF': 75, '연금': 70, '대출금리': 65,
                '담보': 60, '부동산담보': 55, '신용대출': 50, '카드론': 45,
                '예금': 40, '적금': 35, '정기예금': 30, '정기적금': 25,
                '금융상품': 20, '생명보험': 15, '손해보험': 10, '연금보험': 5,
                '퇴직연금': 3, '투자신탁': 1, '사모펀드': 80, '벤처캐피탈': 75,
                '크라우드펀딩': 70, '핀테크': 65, '블록체인': 60, '가상화폐': 55,
                '암호화폐': 50, '디지털자산': 45, '토큰': 40, '스마트컨트랙트': 35,
                '분산금융': 30, '메타버스': 25, 'AI금융': 20, '로보어드바이저': 15,
                '은행상승': 95, '은행하락': 90, '은행급등': 85, '은행급락': 80,
                '은행호조': 75, '은행악화': 70, '은행성장': 65, '은행위축': 60,
                '은행확대': 55, '은행축소': 50, '은행개선': 45, '은행악화': 40,
                '은행회복': 35, '은행위축': 30, '은행확대': 25, '은행축소': 20,
                '은행개선': 15, '은행악화': 10, '은행회복': 5, '은행위축': 3,
                '대출상승': 95, '대출하락': 90, '대출급등': 85, '대출급락': 80,
                '대출호조': 75, '대출악화': 70, '대출성장': 65, '대출위축': 60,
                '대출확대': 55, '대출축소': 50, '대출개선': 45, '대출악화': 40,
                '대출회복': 35, '대출위축': 30, '대출확대': 25, '대출축소': 20,
                '대출개선': 15, '대출악화': 10, '대출회복': 5, '대출위축': 3,
                '펀드상승': 95, '펀드하락': 90, '펀드급등': 85, '펀드급락': 80,
                '펀드호조': 75, '펀드악화': 70, '펀드성장': 65, '펀드위축': 60,
                '펀드확대': 55, '펀드축소': 50, '펀드개선': 45, '펀드악화': 40,
                '펀드회복': 35, '펀드위축': 30, '펀드확대': 25, '펀드축소': 20,
                '펀드개선': 15, '펀드악화': 10, '펀드회복': 5, '펀드위축': 3,
                '보험상승': 95, '보험하락': 90, '보험급등': 85, '보험급락': 80,
                '보험호조': 75, '보험악화': 70, '보험성장': 65, '보험위축': 60,
                '보험확대': 55, '보험축소': 50, '보험개선': 45, '보험악화': 40,
                '보험회복': 35, '보험위축': 30, '보험확대': 25, '보험축소': 20,
                '보험개선': 15, '보험악화': 10, '보험회복': 5, '보험위축': 3,
                '증권상승': 95, '증권하락': 90, '증권급등': 85, '증권급락': 80,
                '증권호조': 75, '증권악화': 70, '증권성장': 65, '증권위축': 60,
                '증권확대': 55, '증권축소': 50, '증권개선': 45, '증권악화': 40,
                '증권회복': 35, '증권위축': 30, '증권확대': 25, '증권축소': 20,
                '증권개선': 15, '증권악화': 10, '증권회복': 5, '증권위축': 3
            },
            'policy_keywords': {
                '금융정책': 100, '통화정책': 95, '규제': 90, '세금': 85,
                '정부지원': 80, '세제혜택': 75, '재정정책': 70, '규제완화': 65,
                '규제강화': 60, '법인세': 55, '소득세': 50, '부가가치세': 45,
                '양도소득세': 40, '증여세': 35, '보조금': 30, '감세': 25,
                '증세': 20, '조세정책': 15, '재정지출': 10, '재정수입': 5,
                '예산': 3, '국채': 1, '지방채': 80, '특별채': 75,
                '개발채': 70, '산업채': 65, '금융채': 60, '회사채': 55,
                'CP': 50, 'CD': 45, 'RP': 40, '국고채': 35, '지방채': 30,
                '금융정책상승': 95, '금융정책하락': 90, '금융정책급등': 85,
                '금융정책급락': 80, '금융정책호조': 75, '금융정책악화': 70,
                '금융정책성장': 65, '금융정책위축': 60, '금융정책확대': 55,
                '금융정책축소': 50, '금융정책개선': 45, '금융정책악화': 40,
                '금융정책회복': 35, '금융정책위축': 30, '금융정책확대': 25,
                '금융정책축소': 20, '금융정책개선': 15, '금융정책악화': 10,
                '금융정책회복': 5, '금융정책위축': 3, '금융정책확대': 1,
                '통화정책상승': 95, '통화정책하락': 90, '통화정책급등': 85,
                '통화정책급락': 80, '통화정책호조': 75, '통화정책악화': 70,
                '통화정책성장': 65, '통화정책위축': 60, '통화정책확대': 55,
                '통화정책축소': 50, '통화정책개선': 45, '통화정책악화': 40,
                '통화정책회복': 35, '통화정책위축': 30, '통화정책확대': 25,
                '통화정책축소': 20, '통화정책개선': 15, '통화정책악화': 10,
                '통화정책회복': 5, '통화정책위축': 3, '통화정책확대': 1,
                '규제상승': 95, '규제하락': 90, '규제급등': 85, '규제급락': 80,
                '규제호조': 75, '규제악화': 70, '규제성장': 65, '규제위축': 60,
                '규제확대': 55, '규제축소': 50, '규제개선': 45, '규제악화': 40,
                '규제회복': 35, '규제위축': 30, '규제확대': 25, '규제축소': 20,
                '규제개선': 15, '규제악화': 10, '규제회복': 5, '규제위축': 3,
                '세금상승': 95, '세금하락': 90, '세금급등': 85, '세금급락': 80,
                '세금호조': 75, '세금악화': 70, '세금성장': 65, '세금위축': 60,
                '세금확대': 55, '세금축소': 50, '세금개선': 45, '세금악화': 40,
                '세금회복': 35, '세금위축': 30, '세금확대': 25, '세금축소': 20,
                '세금개선': 15, '세금악화': 10, '세금회복': 5, '세금위축': 3
            },
            'industry_keywords': {
                '반도체': 100, '자동차': 95, 'IT': 90, '제약': 85,
                '에너지': 80, '부동산': 75, '건설': 70, '조선': 65,
                '철강': 60, '화학': 55, '바이오': 50, '소프트웨어': 45,
                '하드웨어': 40, '인터넷': 35, '모바일': 30, 'AI': 25,
                '블록체인': 20, '석유': 15, '가스': 10, '전기': 5,
                '신재생에너지': 3, '태양광': 1, '풍력': 80, '아파트': 75,
                '오피스텔': 70, '상가': 65, '토지': 60, '재개발': 55,
                '재건축': 50, '도시개발': 45, '신도시': 40, '스마트시티': 35,
                '모빌리티': 30, '전기차': 25, '수소차': 20, '자율주행': 15,
                '반도체상승': 95, '반도체하락': 90, '반도체급등': 85, '반도체급락': 80,
                '반도체호조': 75, '반도체악화': 70, '반도체성장': 65, '반도체위축': 60,
                '반도체확대': 55, '반도체축소': 50, '반도체개선': 45, '반도체악화': 40,
                '반도체회복': 35, '반도체위축': 30, '반도체확대': 25, '반도체축소': 20,
                '반도체개선': 15, '반도체악화': 10, '반도체회복': 5, '반도체위축': 3,
                '자동차상승': 95, '자동차하락': 90, '자동차급등': 85, '자동차급락': 80,
                '자동차호조': 75, '자동차악화': 70, '자동차성장': 65, '자동차위축': 60,
                '자동차확대': 55, '자동차축소': 50, '자동차개선': 45, '자동차악화': 40,
                '자동차회복': 35, '자동차위축': 30, '자동차확대': 25, '자동차축소': 20,
                '자동차개선': 15, '자동차악화': 10, '자동차회복': 5, '자동차위축': 3,
                'IT상승': 95, 'IT하락': 90, 'IT급등': 85, 'IT급락': 80,
                'IT호조': 75, 'IT악화': 70, 'IT성장': 65, 'IT위축': 60,
                'IT확대': 55, 'IT축소': 50, 'IT개선': 45, 'IT악화': 40,
                'IT회복': 35, 'IT위축': 30, 'IT확대': 25, 'IT축소': 20,
                'IT개선': 15, 'IT악화': 10, 'IT회복': 5, 'IT위축': 3,
                '제약상승': 95, '제약하락': 90, '제약급등': 85, '제약급락': 80,
                '제약호조': 75, '제약악화': 70, '제약성장': 65, '제약위축': 60,
                '제약확대': 55, '제약축소': 50, '제약개선': 45, '제약악화': 40,
                '제약회복': 35, '제약위축': 30, '제약확대': 25, '제약축소': 20,
                '제약개선': 15, '제약악화': 10, '제약회복': 5, '제약위축': 3,
                '에너지상승': 95, '에너지하락': 90, '에너지급등': 85, '에너지급락': 80,
                '에너지호조': 75, '에너지악화': 70, '에너지성장': 65, '에너지위축': 60,
                '에너지확대': 55, '에너지축소': 50, '에너지개선': 45, '에너지악화': 40,
                '에너지회복': 35, '에너지위축': 30, '에너지확대': 25, '에너지축소': 20,
                '에너지개선': 15, '에너지악화': 10, '에너지회복': 5, '에너지위축': 3,
                '부동산상승': 95, '부동산하락': 90, '부동산급등': 85, '부동산급락': 80,
                '부동산호조': 75, '부동산악화': 70, '부동산성장': 65, '부동산위축': 60,
                '부동산확대': 55, '부동산축소': 50, '부동산개선': 45, '부동산악화': 40,
                '부동산회복': 35, '부동산위축': 30, '부동산확대': 25, '부동산축소': 20,
                '부동산개선': 15, '부동산악화': 10, '부동산회복': 5, '부동산위축': 3
            }
        }
        
        self.sentiment_keywords = {
            'positive': {
                '상승': 100, '급등': 95, '호조': 90, '성장': 85,
                '확대': 80, '증가': 75, '개선': 70, '회복': 65,
                '돌파': 60, '신고점': 55, '최고점': 50, '기대': 45,
                '긍정': 40, '낙관': 35, '강세': 30, '투자유치': 25,
                '성과': 20, '실적호조': 15, '매출증가': 10, '이익증가': 5,
                '배당증가': 3, '수익성장': 1, '고성장': 80, '급성장': 75,
                '성장세': 70, '호전': 65, '개선세': 60, '회복세': 55,
                '상승세': 50, '강세세': 45, '돌파세': 40, '급등세': 35,
                '신기록': 30, '최고치': 25, '최고점': 20, '기대감': 15,
                '낙관론': 10, '긍정론': 5, '강세론': 3, '상승론': 1,
                '돌파성': 95, '신고점성': 90, '최고점성': 85, '기대성': 80,
                '긍정성': 75, '낙관성': 70, '강세성': 65, '투자유치성': 60,
                '성과성': 55, '실적호조성': 50, '매출증가성': 45, '이익증가성': 40,
                '배당증가성': 35, '수익성장성': 30, '고성장성': 25, '급성장성': 20,
                '성장세성': 15, '호전성': 10, '개선세성': 5, '회복세성': 3,
                '상승세성': 1, '강세세성': 95, '돌파세성': 90, '급등세성': 85,
                '신기록성': 80, '최고치성': 75, '최고점성': 70, '기대감성': 65,
                '낙관론성': 60, '긍정론성': 55, '강세론성': 50, '상승론성': 45,
                '돌파성성': 40, '신고점성성': 35, '최고점성성': 30, '기대성성': 25,
                '긍정성성': 20, '낙관성성': 15, '강세성성': 10, '투자유치성성': 5,
                '성과성성': 3, '실적호조성성': 1
            },
            'negative': {
                '하락': 100, '급락': 95, '악화': 90, '감소': 85,
                '축소': 80, '위축': 75, '부정': 70, '비관': 65,
                '하향': 60, '최저점': 55, '신저점': 50, '우려': 45,
                '리스크': 40, '위험': 35, '약세': 30, '실적악화': 25,
                '손실': 20, '적자': 15, '부도': 10, '파산': 5,
                '청산': 3, '폐업': 1, '하락세': 80, '약세세': 75,
                '악화세': 70, '감소세': 65, '축소세': 60, '위축세': 55,
                '부정세': 50, '비관세': 45, '우려세': 40, '리스크세': 35,
                '위험세': 30, '하향세': 25, '최저치': 20, '신저치': 15,
                '부정론': 10, '비관론': 5, '약세론': 3, '하락론': 1,
                '하락성': 95, '급락성': 90, '악화성': 85, '감소성': 80,
                '축소성': 75, '위축성': 70, '부정성': 65, '비관성': 60,
                '하향성': 55, '최저점성': 50, '신저점성': 45, '우려성': 40,
                '리스크성': 35, '위험성': 30, '약세성': 25, '실적악화성': 20,
                '손실성': 15, '적자성': 10, '부도성': 5, '파산성': 3,
                '청산성': 1, '폐업성': 95, '하락세성': 90, '약세세성': 85,
                '악화세성': 80, '감소세성': 75, '축소세성': 70, '위축세성': 65,
                '부정세성': 60, '비관세성': 55, '우려세성': 50, '리스크세성': 45,
                '위험세성': 40, '하향세성': 35, '최저치성': 30, '신저치성': 25,
                '부정론성': 20, '비관론성': 15, '약세론성': 10, '하락론성': 5,
                '하락성성': 3, '급락성성': 1
            },
            'neutral': {
                '유지': 100, '보합': 95, '안정': 90, '중립': 85,
                '관망': 80, '대기': 75, '검토': 70, '검토중': 65,
                '변화없음': 60, '동결': 55, '동일': 50, '유사': 45,
                '비슷': 40, '일정': 35, '안정세': 30, '보합세': 25,
                '유지세': 20, '중립세': 15, '관망세': 10, '대기세': 5,
                '검토세': 3, '안정론': 1, '보합론': 80, '유지론': 75,
                '중립론': 70, '관망론': 65, '대기론': 60, '검토론': 55,
                '안정성': 50, '보합성': 45, '유지성': 40, '중립성': 35,
                '관망성': 30, '대기성': 25, '검토성': 20, '변화성': 15,
                '유지성성': 95, '보합성성': 90, '안정성성': 85, '중립성성': 80,
                '관망성성': 75, '대기성성': 70, '검토성성': 65, '변화성성': 60,
                '동결성': 55, '동일성': 50, '유사성': 45, '비슷성': 40,
                '일정성': 35, '안정세성': 30, '보합세성': 25, '유지세성': 20,
                '중립세성': 15, '관망세성': 10, '대기세성': 5, '검토세성': 3,
                '안정론성': 1, '보합론성': 95, '유지론성': 90, '중립론성': 85,
                '관망론성': 80, '대기론성': 75, '검토론성': 70, '변화론성': 65,
                '동결론성': 60, '동일론성': 55, '유사론성': 50, '비슷론성': 45,
                '일정론성': 40, '안정세론성': 35, '보합세론성': 30, '유지세론성': 25,
                '중립세론성': 20, '관망세론성': 15, '대기세론성': 10, '검토세론성': 5,
                '변화세론성': 3, '동결세론성': 1
            }
        }
        
        self._create_default_impact_rules()
        print("[금융키워드] 기본 키워드 로드 완료")
    
    def _create_default_impact_rules(self):
        """기본 영향도 룰셋 생성"""
        self.impact_rules = {
            # 긍정적 키워드
            '상승': '긍정적', '급등': '긍정적', '호조': '긍정적', '성장': '긍정적',
            '확대': '긍정적', '증가': '긍정적', '개선': '긍정적', '회복': '긍정적',
            '돌파': '긍정적', '신고점': '긍정적', '기대': '긍정적', '긍정': '긍정적',
            '낙관': '긍정적', '강세': '긍정적', '투자유치': '긍정적', '성과': '긍정적',
            '실적호조': '긍정적', '매출증가': '긍정적', '이익증가': '긍정적', '배당증가': '긍정적',
            
            # 부정적 키워드
            '하락': '부정적', '급락': '부정적', '악화': '부정적', '감소': '부정적',
            '축소': '부정적', '위축': '부정적', '부정': '부정적', '비관': '부정적',
            '하향': '부정적', '최저점': '부정적', '신저점': '부정적', '우려': '부정적',
            '리스크': '부정적', '위험': '부정적', '약세': '부정적', '실적악화': '부정적',
            '손실': '부정적', '적자': '부정적', '부도': '부정적', '파산': '부정적',
            '청산': '부정적', '폐업': '부정적',
            
            # 중립적 키워드
            '유지': '중립적', '보합': '중립적', '안정': '중립적', '중립': '중립적',
            '관망': '중립적', '대기': '중립적', '검토': '중립적', '검토중': '중립적',
            '변화없음': '중립적', '동결': '중립적', '동일': '중립적', '유사': '중립적',
            '비슷': '중립적', '일정': '중립적'
        }
    
    def get_financial_keywords(self, category: Optional[str] = None) -> Dict[str, int]:
        """금융 키워드 반환"""
        if category:
            return self.financial_keywords.get(category, {})
        return self.financial_keywords
    
    def get_sentiment_keywords(self, sentiment: Optional[str] = None) -> Dict[str, int]:
        """감정 키워드 반환"""
        if sentiment:
            return self.sentiment_keywords.get(sentiment, {})
        return self.sentiment_keywords
    
    def get_impact_rules(self) -> Dict[str, str]:
        """영향도 룰셋 반환"""
        return self.impact_rules
    
    def extract_financial_keywords_from_text(self, text: str) -> Dict[str, List[str]]:
        """텍스트에서 금융 키워드 추출"""
        found_keywords = {category: [] for category in self.financial_keywords.keys()}
        
        for category, keywords in self.financial_keywords.items():
            for keyword in keywords.keys():
                if keyword in text:
                    found_keywords[category].append(keyword)
        
        return found_keywords
    
    def extract_sentiment_keywords_from_text(self, text: str) -> Dict[str, List[str]]:
        """텍스트에서 감정 키워드 추출"""
        found_sentiments = {sentiment: [] for sentiment in self.sentiment_keywords.keys()}
        
        for sentiment, keywords in self.sentiment_keywords.items():
            for keyword in keywords.keys():
                if keyword in text:
                    found_sentiments[sentiment].append(keyword)
        
        return found_sentiments
    
    def get_impact_score(self, text: str) -> Dict[str, float]:
        """텍스트의 영향도 점수 계산"""
        sentiment_keywords = self.extract_sentiment_keywords_from_text(text)
        
        positive_count = len(sentiment_keywords.get('positive', []))
        negative_count = len(sentiment_keywords.get('negative', []))
        neutral_count = len(sentiment_keywords.get('neutral', []))
        
        total = positive_count + negative_count + neutral_count
        if total == 0:
            return {'positive': 0.0, 'negative': 0.0, 'neutral': 0.0}
        
        return {
            'positive': positive_count / total,
            'negative': negative_count / total,
            'neutral': neutral_count / total
        }

# 전역 인스턴스
financial_keyword_loader = FinancialKeywordLoader() 